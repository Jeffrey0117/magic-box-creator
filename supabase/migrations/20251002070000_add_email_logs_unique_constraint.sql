-- ==========================================
-- KeyBox: 防止重複領取（資料庫層保護）
-- ==========================================

-- 新增 Unique Constraint
-- 確保同一個 email 不能重複領取同一個 keyword
ALTER TABLE email_logs 
ADD CONSTRAINT email_logs_keyword_email_unique 
UNIQUE (keyword_id, email);

-- ==========================================
-- 說明
-- ==========================================
-- 1. 即使前端檢查失效，資料庫也會拒絕重複插入
-- 2. 這是「防禦性編程」的最佳實踐
-- 3. 與前端檢查形成雙重保護